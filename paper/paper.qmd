---
title: "Frequent Inspections Fail to Curb Violations in Toronto's Good-Standing Food Establishments"
author: 
  - Jerry Xia
thanks: "Code and data are available at: <https://github.com/Jerryx2020/toronto_dinesafe_analysis>"
date: "`r format(Sys.Date() - 1, '%A, %B %d, %Y')`"
date-format: long
abstract: "This study analyzes inspection patterns and compliance outcomes using Toronto’s DineSafe dataset (2022-2024) to explore the relationship between inspection frequency and food safety infractions in restaurants and takeout establishments. The data reveals that restaurants have a higher percentage of inspections resulting in infractions compared to takeout establishments, highlighting more significant compliance challenges in full-service operations. These findings suggest that current regulatory practices may need to focus more on restaurants to ensure public safety. By identifying gaps in inspection frequency and infractions, this analysis highlights the need for more targeted oversight to improve food safety.
"
format: pdf
number-sections: true
toc: true #https://quarto.org/docs/reference/formats/pdf.html
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
```

# Introduction

In large urban centers like Toronto, ensuring food safety is a critical public health priority. Foodborne illnesses pose significant risks, and the health of the population is closely tied to the hygienic practices of food establishments, including restaurants, food trucks, and takeout locations. To address this, the DineSafe program, managed by Toronto Public Health, enforces health and safety regulations by conducting regular inspections of all food service establishments [@citeOpendatatoronto]. These inspections result in outcomes ranging from a pass to a conditional pass or even closure, depending on the establishment's compliance with food safety standards. According to the Centers for Disease Control and Prevention (CDC), frequent and transparent food inspections are instrumental in reducing foodborne illness outbreaks, as public posting of inspection results can encourage better compliance in food service settings [@cdc2024]. Despite this, significant variations exist in the frequency of inspections and the severity of infractions, raising concerns about whether some establishments, particularly mobile or temporary food vendors, receive adequate regulatory attention [@hazel2023].

This study focuses on analyzing Toronto’s DineSafe dataset, covering inspections from 2022 to 2024, to investigate patterns in inspection frequency and compliance outcomes among different types of food establishments. While previous research has broadly examined compliance across food establishments, this paper delves deeper into the relationships between establishment types—such as traditional restaurants and takeout locations—and the severity of infractions identified during inspections. Restaurants exhibit a higher rate of severe infractions compared to takeout establishments, suggesting that full-service operations may require more regulatory oversight to address food safety challenges [@fsa2023].

To address this gap, the DineSafe inspection data for Toronto food establishments was obtained and cleaned as described in @sec-data-overview. The results, presented in @sec-data-results, reveal key trends in the frequency of inspections and the prevalence of infractions across different establishment types. The findings indicate that while mobile food vendors undergo fewer inspections than restaurants, they exhibit a higher rate of severe infractions relative to the number of inspections conducted. These insights, as discussed in @sec-discussion, highlight the need for more frequent inspections or stricter regulations in this sector to ensure public safety.

The remainder of this paper is organized as follows: @sec-data-overview provides a detailed overview of the data and the methodology used to clean and analyze the dataset; @sec-data-results presents the key findings of the analysis, including the inspection frequency and infraction severity; and @sec-discussion concludes with recommendations for improving food safety oversight in Toronto. The appendix includes additional materials, such as code and data, ensuring full reproducibility of the results.

# Data {#sec-data}

## Overview {#sec-data-overview}

This analysis utilizes the DineSafe dataset from Toronto’s Open Data platform, accessed using the `opendatatoronto` package [@citeOpendatatoronto]. The dataset includes inspections conducted from 2022 to 2024, providing detailed information on health inspections of food establishments, including restaurants and takeout locations, throughout Toronto.
 Key variables in the dataset include inspection dates, infraction types, and establishment compliance statuses, which serve as the primary indicators for assessing food safety. These regular inspections are crucial for maintaining food hygiene standards, as highlighted by the CDC, which emphasizes the importance of routine inspections and the public posting of results, such as letter grades, to encourage compliance and reduce foodborne illnesses [@cdc2024].

For this study, only the inspection data for "Restaurant" and "Food Take Out" establishments that passed their most recent inspection were retained. This focus allows for an in-depth exploration of the correlation between inspection frequency and the occurrence of infractions in establishments that are deemed to be in compliance. The DineSafe dataset is updated regularly by Toronto Public Health, and is considered open data under Toronto’s Open Data Licence (@sec-appendix-attribution), as long as proper attribution is provided [@tphlicense].

The data analysis and processing were carried out using the R programming language [@citeR], employing a range of specialized packages. The `tidyverse` package [@citeTidyverse] was used extensively for filtering, cleaning, and summarizing the data. Additionally, the `ggplot2` package [@citeGgplot2] was applied to visualize patterns in inspection frequency and the severity of infractions. Date-related data were managed using the `lubridate` package [@citeLubridate] to ensure consistency in handling inspection dates.

This analysis exclusively focuses on data for restaurants and takeout establishments, as these are among the most common food service types in Toronto, and represent a significant portion of the inspections carried out by public health authorities. As described in @sec-data-results, the dataset was thoroughly cleaned and prepared for analysis, ensuring that all irrelevant fields were removed and the remaining data was formatted for accurate analysis.

\newpage

## Results {#sec-data-results}

```{r}
#| echo: false
#| warning: false
#| fig-cap: "Inspection Count vs Infraction Count per Establishment"
#| label: fig-inspection-vs-infraction

# Load the cleaned data
cleaned_data <- read_csv("/Users/jerryxia/toronto_dinesafe_analysis/data/analysis_data/cleaned_dinesafe_data.csv")

# First Graph: Inspection Count vs Confirmed Infraction Count per Establishment
# This will only count actual infractions and ignore "No Infraction"
inspection_infraction_data <- cleaned_data %>%
  group_by(`Establishment ID`) %>%
  summarise(
    inspection_count = n(),  # Total number of inspections
    infraction_count = sum(Severity != "No Infraction" & !is.na(Severity))  # Count confirmed infractions only
  )

# Plot the adjusted graph
ggplot(inspection_infraction_data, aes(x = inspection_count, y = infraction_count)) +
  geom_point(color = "purple", size = 2, alpha = 0.7) +  # Purple dots
  geom_smooth(method = "lm", color = "darkgray", linetype = "dashed", se = FALSE) +  # Regression line
  scale_x_continuous(breaks = seq(0, 60, by = 10)) +  
  scale_y_continuous(breaks = seq(0, 60, by = 10)) +  
  labs(x = "Number of Inspections",
       y = "Number of Confirmed Infractions") +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

```

As shown in @fig-inspection-vs-infraction, the graph now excludes only inspections where "No Infraction" was recorded. The results show that establishments inspected more frequently tend to have higher counts of infractions. This positive correlation reflects findings from the literature that increased inspection frequency does not necessarily reduce violations but instead highlights pre-existing issues [@mdpi2023; @cdc2024]. The data was processed using the `tidyverse` package for summarization and visualization [@citeTidyverse], while the plots were generated using `ggplot2` [@citeGgplot2].

\newpage

```{r}
#| echo: false
#| warning: false
#| fig-cap: "Number of Inspections Conducted Over Time (Monthly)"
#| label: fig-inspections-over-time

# Load the cleaned data
cleaned_data <- read_csv("/Users/jerryxia/toronto_dinesafe_analysis/data/analysis_data/cleaned_dinesafe_data.csv")

# Second Graph: Time Series of Inspections Over Time (Monthly)
inspections_over_time <- cleaned_data %>%
  filter(Severity != "No Infraction") %>%  # Exclude only "No Infraction"
  mutate(`Inspection Date` = as.Date(`Inspection Date`, format = "%Y-%m-%d")) %>%
  group_by(month = lubridate::floor_date(`Inspection Date`, "month")) %>%  # Group by month
  summarise(inspections = n())  # Summarize total inspections per month

# Plot with more refined styling and complexity
ggplot(inspections_over_time, aes(x = month, y = inspections)) +
  geom_line(color = "black", size = 1.2) +  # Grayscale line for monthly inspections
  geom_point(color = "purple", size = 2, alpha = 0.8) +  # Purple points for each month
  labs(x = "Month",
       y = "Number of Inspections") +
  scale_x_date(date_labels = "%b %Y", date_breaks = "3 months") +  # Customize date labels and breaks
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12), 
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1),  # Rotate x-axis labels for readability
    axis.text.y = element_text(size = 10, color = "black"),  # Style y-axis ticks
    panel.grid.major = element_line(size = 0.2, color = "gray80"),  # Lighter grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines
  )

```

As shown in @fig-inspections-over-time, the number of inspections fluctuates month by month. Several external factors, such as regulatory changes, seasonal variations, or public health crises like the COVID-19 pandemic, likely influence these inconsistencies in inspection activity [@hazel2023]. The visualization was created using `ggplot2` [@citeGgplot2] for plotting and `lubridate` [@citeLubridate] for time-based grouping.



\newpage

```{r}
#| echo: false
#| warning: false
#| fig-cap: "Percentage of Inspections Resulting in Infractions: Restaurants vs. Takeout"
#| label: fig-restaurant-vs-takeout

# Third Graph: Percentage of Inspections with Infractions for Restaurants vs. Takeout
type_percentage_comparison <- cleaned_data %>%
  group_by(`Establishment Type`) %>%
  summarise(
    total_inspections = n(),
    inspections_with_infractions = sum(Severity != "No Infraction")  # Count inspections where infraction is present
  ) %>%
  mutate(percentage_with_infractions = (inspections_with_infractions / total_inspections) * 100)

# Refined plot with purple percentage numbers
ggplot(type_percentage_comparison, aes(x = `Establishment Type`, y = percentage_with_infractions)) +
  geom_bar(stat = "identity", fill = "gray40", color = "black", width = 0.6) +  # Grayscale bar with refined styling
  geom_text(aes(label = sprintf("%.1f%%", percentage_with_infractions)), vjust = -0.5, size = 5, color = "purple") +  # Purple labels
  ylim(0, 80) +  # Increase the limit of the y-axis to give more space at the top
  labs(x = "Establishment Type",
       y = "Percentage of Inspections with Infractions (%)") +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 11),  # Style x-axis label
    axis.title.y = element_text(size =11),  # Style y-axis label
    axis.text.x = element_text(size = 12),  # Style x-axis ticks
    axis.text.y = element_text(size = 12),  # Style y-axis ticks
    panel.grid.major = element_line(size = 0.2, color = "gray80"),  # Lighter grid lines
    panel.grid.minor = element_blank()  # Remove minor grid lines
  )

```
As shown in @fig-restaurant-vs-takeout, the percentage of inspections resulting in infractions is higher for restaurants (73.4%) compared to takeout establishments (58.6%). This indicates that despite takeout establishments being subject to fewer total inspections due to their smaller numbers, restaurants have a greater percentage of infractions per inspection. This could suggest that full-service restaurants face more complex operational challenges that increase the likelihood of non-compliance with food safety regulations. Research has shown that full-service restaurants, due to the complexity of food handling processes, tend to have higher rates of infractions compared to smaller or more specialized establishments [@hazel2023; @fsa2023]. These findings underscore the need for continued regulatory focus on restaurants, where maintaining compliance appears more difficult, reflecting the operational differences between full-service restaurants and takeout locations [@cdc2024].


\newpage

# Discussion {#sec-discussion}

The analysis of the DineSafe data revealed several key insights into food safety practices across Toronto's restaurants and takeout establishments. One notable observation, as depicted in @fig-inspection-vs-infraction and discussed in @sec-data-results, is the positive correlation between the number of inspections conducted at an establishment and the number of infractions identified. This finding suggests that more frequent inspections tend to uncover more infractions. However, it raises the question of whether these inspections are uncovering ongoing compliance issues rather than fostering improvements. Similar conclusions have been noted in previous studies, which found that increased inspection frequency highlights existing compliance problems without necessarily reducing the overall number of violations [@mdpi2023; @cdc2024].

When examining the number of inspections conducted over time, as shown in @fig-inspections-over-time, and detailed in @sec-data-results, the data indicates inconsistencies in inspection activity. These variations are likely influenced by external factors such as regulatory changes, public health events (e.g., the COVID-19 pandemic), or operational adjustments [@hazel2023]. While spikes in inspection activity may correspond to heightened public health concerns, ensuring sustained compliance requires consistent follow-up actions. Without continuous enforcement measures, temporary increases in inspections may not lead to long-term reductions in infractions.

@fig-restaurant-vs-takeout in @sec-data-results compares the percentage of inspections resulting in infractions between restaurants and takeout establishments. Restaurants, with a 73.4% infraction rate compared to 58.6% for takeout establishments (@fig-restaurant-vs-takeout), face greater compliance challenges, suggesting a need for enhanced regulatory scrutiny. This suggests that full-service restaurants, due to their operational complexity, may face greater compliance challenges with food safety regulations. This observation is consistent with other research that highlights the difficulties full-service restaurants experience in maintaining hygiene and safety standards, as their more complex operations involve multiple stages of food preparation and handling [@hazel2023; @fsa2023]. These findings underscore the importance of focused regulatory oversight on restaurants, where compliance challenges appear more prevalent.

Despite the valuable insights provided by this analysis, certain limitations must be acknowledged. As noted in @sec-data-results, the DineSafe dataset may not capture all infractions, especially for establishments classified as low-risk and inspected less frequently. This underrepresentation could result in an incomplete view of food safety compliance across the city. Moreover, some infractions may not lead to immediate enforcement actions (e.g., fines or closures), potentially allowing non-compliance to persist over time. Addressing these limitations may require additional measures such as follow-up inspections and broadening the range of establishments subject to frequent scrutiny [@citeOpendatatoronto].

Future research could investigate the application of machine learning techniques to predict which establishments are most likely to fail inspections based on historical data, allowing regulatory bodies to allocate resources more efficiently [@mdpi2023]. Additionally, more detailed studies into the effectiveness of enforcement actions, such as fines and mandatory re-inspections, could provide insights into strategies for improving compliance rates. Comparative analyses between cities with varying levels of transparency, such as public disclosure of inspection scores, could further illuminate best practices for reducing foodborne illness outbreaks and enhancing compliance, as discussed in @sec-discussion.

In conclusion, while the DineSafe program has been successful in identifying non-compliant establishments, this study suggests that frequent inspections alone are not enough to prevent food safety violations. Targeted regulatory interventions, particularly in high-risk and complex food service sectors like full-service restaurants, may be required to strengthen compliance and safeguard public health in Toronto.


\newpage

\appendix

# Appendix {#sec-appendix}

## Dataset and Graph Sketches {#sec-appendix-sketches}
Sketches depicting both the desired dataset and the graphs generated in this analysis are available in the GitHub Repository.

## Data Cleaning {#sec-appendix-cleaning}
The data cleaning process was essential to prepare the raw DineSafe dataset for accurate analysis. Initially, we filtered the data to focus exclusively on "Restaurant" and "Food Take Out" establishments that had passed their most recent inspection. This ensured that our analysis targeted establishments in good standing, allowing us to assess how inspection frequency correlates with violations in compliant establishments.

Next, we removed irrelevant columns to simplify the dataset and enhance clarity. For example, columns unrelated to inspection outcomes or establishment types were excluded. Additionally, we ensured consistency across the dataset by renaming certain columns for clarity and ease of analysis.

To handle date-related data, we utilized the lubridate package [@citeLubridate], which enabled consistent date formatting and facilitated time-based analysis. The entire data cleaning process was carried out using the tidyverse package [@citeTidyverse], which streamlined the filtering, mutating, and summarizing operations essential for preparing the dataset for further exploration.


## Attribution Statement {#sec-appendix-attribution}
"Contains information licensed under the Open Government Licence – Toronto" [@tphlicense].

\newpage

# References {#sec-references}
