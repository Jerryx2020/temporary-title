---
title: "Frequent Inspections Fail to Curb Violations in Toronto's Good-Standing Food Establishments"
author: 
  - Jerry Xia
thanks: "Code and data are available at: <https://github.com/Jerryx2020/toronto_dinesafe_analysis>"
date: today
date-format: long
abstract: ""
format: pdf
number-sections: true
toc: true #https://quarto.org/docs/reference/formats/pdf.html
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
```

# Introduction

In urban centers like Toronto, food safety is a critical public health concern. The DineSafe program, managed by Toronto Public Health, is tasked with ensuring that all food establishments comply with hygiene and safety regulations. Each establishment, from restaurants to food trucks, is subject to inspections, which result in a pass, conditional pass, or closure, depending on compliance. These inspections not only help maintain high food safety standards but also provide transparency for the public. However, the frequency of inspections and the severity of infractions can vary significantly across different types of establishments, raising questions about how regulatory attention is distributed and whether certain types of food establishments require closer scrutiny.

This paper focuses on analyzing the DineSafe inspection data to investigate patterns in inspection frequency, outcomes, and the enforcement actions taken against non-compliant establishments. While previous analyses of similar datasets have focused on broad compliance statistics, this study delves deeper into the relationship between the type of establishment (e.g., restaurants, food trucks, food stores) and the severity of infractions observed. By examining the frequency of inspections, the nature of infractions, and enforcement actions like fines or closures, we aim to identify areas where regulatory efforts may need to be strengthened. Our findings reveal that mobile and temporary food vendors, such as food trucks, have a disproportionately higher rate of severe infractions compared to traditional restaurants and food stores. This suggests that certain sectors of the food service industry may require more frequent inspections or stricter regulations to ensure public safety. Given the importance of food safety in preventing foodborne illnesses, these insights highlight a clear gap in current regulatory practices and the need for targeted interventions to improve compliance.

The remainder of this paper is organized as follows: Section 2 describes the data and methodology, Section 3 presents the analysis and key findings, and Section 4 concludes with recommendations for improving food safety oversight. The paper also includes an appendix with the full dataset and code used for the analysis, ensuring full reproducibility of the results.

# Data {#sec-data}

## Overview {#sec-data-overview}

This study uses the DineSafe dataset from Torontoâ€™s Open Data platform, accessed using the `opendatatoronto` package [@citeOpendatatoronto]. This dataset provides detailed information on health inspections for food establishments, including restaurants and takeout locations. The dataset includes critical fields such as inspection dates, types of infractions, and establishment compliance statuses. According to the CDC, regular inspections and public posting of results, such as letter grades, play a crucial role in reducing foodborne illnesses by encouraging compliance in food service establishments [@cdc2024]. However, as revealed by a 2023 report from Hazel Analytics, issues such as inadequate handwashing and improper sanitization remain significant, particularly in the post-pandemic environment [@hazel2023].

For the purposes of this analysis, the data was cleaned using the `tidyverse` package [@citeTidyverse], which allowed for efficient filtering of relevant columns. Only data for "Restaurant" and "Food Take Out" establishments that had passed their most recent inspection were retained. This focus narrows the analysis to establishments in compliance, allowing us to explore how frequent inspections correlate with violations. We then used the `ggplot2` package for visualizing these patterns [@citeGgplot2].

## Results {#sec-data-results}


```{r}
#| echo: false
#| warning: false
#| fig-cap: "Inspection Count vs Infraction Count per Establishment"
#| label: fig-inspection-vs-infraction

# Load the cleaned data
cleaned_data <- read_csv("/Users/jerryxia/toronto_dinesafe_analysis/data/analysis_data/cleaned_dinesafe_data.csv")

# First Graph: Inspection Count vs Infraction Count per Establishment
inspection_infraction_data <- cleaned_data %>%
  group_by(`Establishment ID`) %>%
  summarise(inspection_count = n(),
            infraction_count = sum(!is.na(Severity)))

ggplot(inspection_infraction_data, aes(x = inspection_count, y = infraction_count)) +
  geom_point(color = "blue", alpha = 0.6) +
  labs(title = "Inspection Count vs Infraction Count per Establishment",
       x = "Number of Inspections",
       y = "Number of Infractions") +
  theme_minimal()

```

As shown in @fig-inspection-vs-infraction, establishments inspected more frequently tend to have higher counts of infractions. This positive correlation reflects findings from literature that increased inspection frequency does not necessarily reduce violations but instead highlights pre-existing issues [@mdpi2023; @cdc2024]. The data was handled using the `tidyverse` package for summarization and visualization [@citeTidyverse], while the plots were generated using `ggplot2` [@citeGgplot2].


```{r}
#| echo: false
#| warning: false
#| fig-cap: "Number of Inspections Conducted Over Time"
#| label: fig-inspections-over-time

# Second Graph: Time Series of Inspections Over Time
inspections_over_time <- cleaned_data %>%
  mutate(`Inspection Date` = as.Date(`Inspection Date`, format = "%Y-%m-%d")) %>%
  group_by(year = lubridate::year(`Inspection Date`)) %>%
  summarise(inspections = n())

ggplot(inspections_over_time, aes(x = year, y = inspections)) +
  geom_line(color = "purple") +
  labs(title = "Number of Inspections Over Time",
       x = "Year",
       y = "Number of Inspections") +
  theme_minimal()

```

As shown in @fig-inspections-over-time, the number of inspections fluctuated across the years. These variations are likely driven by external factors, such as regulatory changes or public health crises, including the COVID-19 pandemic [@hazel2023]. The visualization was created using `ggplot2` [@citeGgplot2] and time-based grouping was managed via `lubridate` [@citeLubridate].


```{r}
#| echo: false
#| warning: false
#| fig-cap: "Comparison of Infractions Between Restaurants and Takeout Establishments"
#| label: fig-restaurant-vs-takeout

# Third Graph: Comparison of Restaurants and Takeout Infractions
type_comparison <- cleaned_data %>%
  group_by(`Establishment Type`) %>%
  summarise(inspection_count = n(),
            infraction_count = sum(!is.na(Severity)))

ggplot(type_comparison, aes(x = `Establishment Type`, y = infraction_count, fill = `Establishment Type`)) +
  geom_bar(stat = "identity") +
  labs(title = "Comparison of Infractions: Restaurants vs. Takeout",
       x = "Establishment Type",
       y = "Number of Infractions") +
  theme_minimal()

```

@fig-restaurant-vs-takeout compares the infractions between restaurants and takeout establishments, indicating that restaurants tend to have slightly more violations. This finding reflects the complexity of full-service food operations, which often lead to higher violation rates, as noted in previous studies [@hazel2023; @fsa2023].

\newpage

# Discussion {#sec-discussion}

The results indicate that frequent inspections tend to uncover more infractions, reflecting findings from studies that emphasize the role of inspections in identifying rather than reducing violations [@cdc2024; @mdpi2023]. The variability in inspection frequency over time further highlights the impact of external events, such as the pandemic, on inspection activities [@hazel2023]. Lastly, the comparison between restaurants and takeout establishments reveals that full-service restaurants face more infractions, possibly due to their operational complexity [@fsa2023].

\newpage

\appendix

# Appendix {#sec-appendix}

## Dataset and Graph Sketches {#sec-appendix-sketches}


## Data Cleaning {#sec-appendix-cleaning}



## Attribution Statement {#sec-appendix-attribution}



\newpage

# References {#sec-references}
